## TinyBASIC2

This Z80 version was built and tested with my [Z80 dongle](https://github.com/Ho-Ro/Z80_dongle).
Originally written in 8080 syntax I converted it to the nicer Z80 syntax using the
[8080 z80](https://hc-ddr.hucki.net/wiki/doku.php/cpm/8080_z80) tool and assembled it with the
[zmac](https://github.com/gp48k/zmac) assembler (with [one fix](https://github.com/Ho-Ro/zmac/tree/fix_hash)).
I also added some HW-oriented functionality like `GET(addr)`, `PUT addr,val,val,...` as well as char constants (`'x'`)
and hex constants that are written as `$xxxx` and the possibility to print values as `uint16_t`
in different number bases n=2..16 using the format specifier `%n`, e.g.
`PRINT %16,expression,...` prints in unsigned hex up to the end of this `PRINT` statement.
The BASIC statement `BYE` executes the Z80 opcode `HALT` that halts the CPU.

*TinyBASIC2* supports
the arithmetic operators `*`, `/`, `&` (level 3), `+`, `-`, `|` (level 2) and the logical operators
`=`, `#` or `<>`, `<=`, `<`, `>=`, `>` (level 1) with decreasing priority level.
*TinyBASIC2* interpreter with my additions still uses less than 2K ROM.

```
TB2

OK
>
```

### Tiny BASIC examples ###

This little code line uses my HW extensions to hex-dump the content of the program memory.

```
>10 for a=$900 to top-size-1; print #4,%16,get(a),; next a
>run
   $A  $0 $66 $6F $72 $20 $61 $3D $24 $39 $30 $30 $20 $74 $6F $20
  $74 $6F $70 $2D $73 $69 $7A $65 $2D $31 $3B $20 $70 $72 $69 $6E
  $74 $20 $23 $34 $2C $25 $31 $36 $2C $67 $65 $74 $28 $61 $29 $2C
  $3B $20 $6E $65 $78 $74 $20 $61  $D
OK
```

Each line starts with the line number stored as int16_t followed by the unchanged ASCII text finished with CR.
To save space commands can be abbreviated with a full stop (and become almost unreadable).

```
>10 f.a=$900 t.t.-s.-1;p.#4,%16,g.(a),;n.a
>run
   $A  $0 $66 $2E $61 $3D $24 $39 $30 $30 $20 $74 $2E $74 $2E $2D
  $73 $2E $2D $31 $3B $70 $2E $23 $34 $2C $25 $31 $36 $2C $67 $2E
  $28 $61 $29 $2C $3B $6E $2E $61  $D
OK
```

Depending on the context `t.` could either be the constant `top` or the statement `to`,
same for `get()` and `goto`.

The `USR()` function calls the Z80 opcode at address `TOP` (i.e. RAM end - 0x100) with the
argument passed in register `HL` and returns the result in register `HL`.
This not very useful example puts the Z80 opcodes `INC HL` and `RET` into the `USR` program space and calls it
via the funtion `USR(123)`.

```
>put top,$23,$c9; REM: INC HL;  RET

OK
>print usr(123)
     124

OK
```

The `USR` function can also be used to output single ASCII chars:

```
>put top,$7d,$d7,$c9; REM: LD A,L;  RST ROUTC;  RET
>for a='a' to 'z'; x=usr(a); next a; x=usr($0d)
abcdefghijklmnopqrstuvwxyz

OK
```

### Z80-MBC2 version

The I/O functions `ROUTC` and `CHKIO` and the memory size were modified for the `iLoad` command of the
[Z80-MBC2](https://github.com/Ho-Ro/Z80-MBC2).

*TinyBASIC2* can be build with the [zmac](https://github.com/gp48k/zmac) assembler.

### Commands TinyBASIC2

